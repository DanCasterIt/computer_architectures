DIM EQU 10
.MODEL small
.STACK
.DATA
DAYLIGHT DW 4 DUP(04F42H,02BA2H,0E822H,09042H)
        ;DUP(1|3|26|2, 0|10|29|2, 3|10|1|2, 2|4|2|2) HC|month|day|hour
AC_NAME DB DIM,DIM+1 DUP(?) ;TORINO
AC_TIMEZONE DB 1 ;GTM+1
AC_POSITION DB 0 ;NORD
BC_NAME DB DIM,DIM+1 DUP(?) ;SYDNEY
BC_TIMEZONE DB 10 ;GTM+10
BC_POSITION DB 1 ;SUD
MONTHS DB 12 DUP(31,28,31,30,31,30,31,31,30,31,30,31)
TIME DW 1B6AH ; giune 27 @ 10:00
BUFF DB ?
.CODE
.STARTUP
;check if year is leap or not and modify MONTHS[1]
;input and output A
		MOV AH, AC_TIMEZONE
		MOV AL, AC_POSITION
		MOV DX, TIME
		CALL CNTRL
;print city1 DST
		MOV BH, BC_TIMEZONE
		CMP DI, 2
		JNE NXT1
		XOR DI, DI
NXT1:
		SUB BH, AH
		MOV DL, BH
		ADD DX, DI
		PUSH DX
		AND DL, 00011111B
		CMP DL, 24
		JB NXT8
		POP DX
		AND DL, 11100000B
		ADD DX, 0020H
		PUSH DX
NXT8:
		POP DX
		PUSH DX
		MOV DH, BUFF
		SHR DX, 5
		AND DL, 00011111B
		MOV BUFF, DH
		SHR DH, 2
		PUSH DX
		MOV DL, DH
		XOR DH, DH
		MOV SI, DX
		POP DX
		CMP DL, MONTHS[SI]
		JB NXT9
		POP DX
		AND DX, 0FC1FH
		PUSH DX
NXT9:
		POP DX
		PUSH DX
		SHR DH, 2
		CMP DH, 12
		JB NXT10
		POP DX
		AND DX, 0C3FFH
		PUSH DX
NXT10:
		POP DX
;print resulting time
		MOV AL, BC_POSITION
		CALL CNTRL
;print city2 DST
		PUSH DX
		XOR DH, DH
		AND DL, 00001111B
		MOV AX, 18
		CALL INTERVAL
		POP DX
		CMP DI, 1
		JNE EXIT
		MOV CX, DX
		AND CL, 00001111B
		OR CL, 18
		SUB CX, DX
;print meeting hours
EXIT:
.EXIT
CNTRL PROC
		MOV DI, 2
		CMP AL, 0
		JNE NXT2
		MOV SI, 0
		MOV BX, DAYLIGHT[SI]
		AND BH, 00111111B
		MOV SI, 2
		MOV CX, DAYLIGHT[SI]
		AND CH, 00111111B
		CMP BX, CX
		JA NXT3
		ADD CX, 12
NXT3:
		CALL INTERVAL
NXT2:
		CMP AL, 1
		JNE NXT6
		MOV SI, 4
		MOV BX, DAYLIGHT[SI]
		AND BH, 00111111B
		MOV SI, 6
		MOV CX, DAYLIGHT[SI]
		AND CH, 00111111B
		CMP BX, CX
		JA NXT7
		ADD CX, 12
NXT7:
		CALL INTERVAL
NXT6:
		RET
CNTRL ENDP
INTERVAL PROC
		CMP DX, BX
		JB NXT4
		CMP DX, CX
		JA NXT4
		MOV DI, 1
		JMP NXT5
NXT4:
		MOV DI, 0
NXT5:
		RET
INTERVAL ENDP
END