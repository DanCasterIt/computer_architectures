D_CITA EQU 6
D_CITB EQU D_CITA+1
D_MAX EQU 63
.MODEL .small
.STACK
.DATA
;CITATIONS DW D_CITA,D_CITB DUP(1081H,3081H,5081H,7080H,8042H,9141H)
						;DUP(1|2|1, 3|2|1, 5|2|1, 7|2|0, 8|1|2, 9|5|1)
						;H_INDEX = 2
;CITATIONS DW D_CITA,D_CITB DUP(1080H,3080H,5080H,7080H,8040H,9140H)
                        ;DUP(1|2|0, 3|2|0, 5|2|0, 7|2|0, 8|1|0, 9|5|0)
						;H_INDEX = 2
;CITATIONS DW D_CITA,D_CITB DUP(1100H,3100H,5140H,7180H,8040H,9000H)
                        ;DUP(1|4|0, 3|4|0, 5|5|0, 7|6|0, 8|1|0, 9|0|0)
						;H_INDEX = 4
;CITATIONS DW D_CITA,D_CITB DUP(1040H,3040H,5040H,7000H,8080H,9040H)
                        ;DUP(1|1|0, 3|1|0, 5|1|0, 7|0|0, 8|2|0, 9|1|0)
						;H_INDEX = 1
CITATIONS DW D_CITA,D_CITB DUP(1100H,3100H,50C0H,7080H,8040H,9100H)
                        ;DUP(1|4|0, 3|4|0, 5|3|0, 7|2|0, 8|1|0, 9|4|0) 
						;H_INDEX = 3
MAX_ARR DB D_MAX DUP(0)
MAX DW D_MAX
H_INDEX DW 0
.CODE
.STARTUP
		MOV CX, D_CITA
		MOV SI, 2
LOOP1:
		MOV AX, CITATIONS[SI]
		MOV BL, AL
		SHL AX, 2
		MOV AL, BL
		AND AH, 00111111B
		AND AL, 00111111B
		CMP AH, AL
		JA GREATER
		XOR AH, AH
		MOV DI, AX
		MOV BL, MAX_ARR[DI]
		ADD BX, 1
		MOV MAX_ARR[DI], BL
		JMP NXT1
GREATER:
        MOV AL, AH         
		XOR AH, AH
		MOV DI, AX
		MOV BL, MAX_ARR[DI]
		ADD BX, 1
		MOV MAX_ARR[DI], BL
NXT1:
		ADD SI, 2
		LOOP LOOP1
RLOOP:
		MOV DX, MAX
		MOV CX, D_MAX
		XOR SI, SI
		XOR BX, BX
		XOR AX, AX
LOOP2:
		MOV AL, MAX_ARR[SI]
		CMP DX, AX
		JB NXT2
		CMP AX, BX
		JB NXT2
		MOV BX, AX
		PUSH SI
NXT2:
		INC SI
		LOOP LOOP2
		POP AX
		CMP AX, BX
		JA NXT3
		JMP FINISH
NXT3:
		MOV SI, AX
		MOV CX, D_MAX
		SUB CX, SI
		XOR DX, DX
LOOP3:
		ADD DL, MAX_ARR[SI]
		INC SI
		LOOP LOOP3
		CMP DX, AX
		JA FINISH
		JE FINISH
		DEC BX
		MOV MAX, BX
		JMP RLOOP
FINISH:
		MOV H_INDEX, AX
.EXIT
		END